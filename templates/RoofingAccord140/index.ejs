<%
/* ===== Minimal helpers & defaults (safe) ===== */
var defaults = {
  // Producer / Agency
  producerName: "All Access Ins, dba Commercial Insurance Direct LLC",
  producerAddress1: "9200 W Cross Drive #515",
  producerAddress2: "Littleton, CO 80123",
  producerContact: "Rick Cline or Gerry Jones",
  
 // Header / Policy meta
  date: "",  // Will come from data mapping
  effectiveDate: "",
  carrier: "",
  naicCode: "",
  policyNumber: "",
  agencyCustomerId: "",
  
  // Applicant / Named Insured
  applicant_name: "",
  namedInsured: "",
  
  // Premises info (page 1)
  premises_number: "",
  building_number: "",
  premise_address: "",
  premise_city: "",
  premise_state: "",
  premise_zip: "",
  bldg_description: "",
  
  // Blanket Summary
  blanket1_amount: "",
  blanket1_type: "",
  blanket2_amount: "",
  blanket2_type: "",
  
  // Subject of Insurance - full 10-column table
  // Row 1 - Building
  building_amount: "",
  building_valuation: "",
  building_coins: "",
  building_causes: "",
  building_ded: "",
  building_premium: "",
  building_blkt: "",
  building_infl: "",
  building_ded_type: "",
  
  // Row 2 - Business Personal Property
  bpp_amount: "",
  bpp_valuation: "ALS",
  bpp_coins: "",
  bpp_causes: "",
  bpp_ded: "$2500",
  bpp_premium: "",
  bpp_blkt: "",
  bpp_infl: "",
  bpp_ded_type: "",
  
  // Row 3 - Business Income
  bi_amount: "",
  bi_valuation: "",
  bi_coins: "",
  bi_causes: "",
  bi_ded: "",
  bi_premium: "",
  bi_blkt: "",
  bi_infl: "",
  bi_ded_type: "",
  
  // Additional rows for other subjects
  other1_subject: "",
  other1_amount: "",
  other1_valuation: "",
  other1_coins: "",
  other1_causes: "",
  other1_ded: "",
  other1_premium: "",
  other1_blkt: "",
  other1_infl: "",
  other1_ded_type: "",
  
  // Additional Information section
  business_income_extra_expense: "",
  value_reporting_info: "",
  
  // Additional Coverages
  spoilage_coverage: "",
  spoilage_limit: "",
  spoilage_ded: "",
  spoilage_refrig_maint: "",
  spoilage_yes: "",
  
  breakdown_contamination: "",
  power_outage: "",
  selling_price: "",
  
  // Sinkhole/Mine Subsidence
  sinkhole_accept: "",
  sinkhole_reject: "",
  sinkhole_limit: "",
  sinkhole_type: "",
  sinkhole_ded: "",
  
  mine_subsidence_accept: "",
  mine_subsidence_reject: "",
  mine_subsidence_limit: "",
  
  // Construction Details
  construction_type: "",
  distance_hydrant: "",
  distance_fire_stat: "",
  fire_district: "",
  code_number: "",
  prot_class: "",
  num_stories: "2",
  num_basements: "",
  year_built: "2020",
  total_area: "2500",
  
  tax_code: "",
  roof_type: "",
  other_occupancies: "",
  bldg_code: "",
  grade: "",
  wind_class: "",
  
  // Building Improvements Years
  wiring_year: "",
  roofing_year: "",
  plumbing_year: "",
  heating_year: "",
  other_year: "",
  
  // Sprinkler System
  percent_sprinkler: "Yes",
  central_station_sprinkler: "",
  local_gong_sprinkler: "",
  
  // Fire Protection
  fire_alarm_manufacturer: "",
  fire_alarm_type: "",
  
  // Heating Source
  heating_source_wood: "",
  stove_fireplace: "",
  manufacturer: "",
  date_installed: "",
  
  primary_heat_boiler: "",
  primary_heat_solid_fuel: "",
  primary_heat_insurance: "",
  
  secondary_heat_boiler: "",
  secondary_heat_solid_fuel: "",
  secondary_heat_insurance: "",
  
  // Open Sides
  num_open_sides: "",
  
  // Exposures
  front_exposure: "",
  front_distance: "",
  right_exposure: "",
  right_distance: "",
  left_exposure: "",
  left_distance: "",
  rear_exposure: "",
  rear_distance: "",
  
  // Burglar Alarm
  burglar_alarm_type: "Yes",
  burglar_alarm_cert: "",
  burglar_alarm_exp: "",
  burglar_alarm_installer: "",
  burglar_alarm_extent: "",
  burglar_alarm_grade: "",
  central_station_burglar: "",
  with_keys: "",
  num_guards: "",
  clock_hourly: "",
  
  // Historical Landmark
  historical_landmark: "",
  
  // Additional Interest
  interest_type: "", // ADDITIONAL_INSURED, LOSS_PAYEE, MORTGAGEE, LIENHOLDER, LENDERS_LOSS
  interest_name: "",
  interest_address: "",
  interest_rank: "",
  interest_evidence: "",
  interest_cert: "",
  interest_reference: "",
  interest_location: "",
  interest_building: "",
  interest_item_class: "",
  interest_item_desc: "",
  
  // Additional Premises (Page 2)
  addl_premises_notes: "",
  
  // Remarks
  remarks: "",
  
  // Signature
  producerSignatureName: "Rick Cline"
};

var data = Object.assign({}, defaults, (typeof formData === "object" && formData) || {});

  // === COMPAT SHIM (safe; no layout changes) ===
(function () {
  // Dates (support old/new keys)
  const CURR_DATE = data.current_date || data.date || "";
  const EFF_DATE  = data.effective_date || data.effectiveDate || "";
  const EXP_DATE  = data.expiration_date || data.expirationDate || "";

  data.current_date = CURR_DATE;      data.date = CURR_DATE;
  data.effective_date = EFF_DATE;     data.effectiveDate = EFF_DATE;
  data.expiration_date = EXP_DATE;    data.expirationDate = EXP_DATE;

  // Applicant street + City/State/Zip (works even if enricher didn't set)
  const street = data.applicant_street || data.premise_address || data.applicant_mailing_address || "";
  const csz = data.applicant_city_state_zip
    || [data.premise_city || data.applicant_city, data.premise_state || data.applicant_state, data.premise_zip || data.applicant_zip]
         .filter(Boolean).join(", ");
  data.applicant_street = street;
  data.applicant_city_state_zip = csz;

    // Additional Interest #1 (normalize + backfill)
  const aiName = data.ai_name_1 || data.additionalInsuredName || data.interest_name || "";
  const aiAddr = data.ai_address_1 || data.additionalInsuredAddress || data.interest_address || "";
  data.ai_name_1 = data.ai_name_1 || aiName;
  data.ai_address_1 = data.ai_address_1 || aiAddr;
  data.ai_city_1 = data.ai_city_1 || data.additionalInsuredCity || data.interest_city || "";
  data.ai_state_1 = data.ai_state_1 || data.additionalInsuredState || data.interest_state || "";
  data.ai_zip_1  = data.ai_zip_1  || data.additionalInsuredZip  || data.interest_zip  || "";

  // BPP (for 140; harmless elsewhere)
  const bpp = data.business_personal_property_clean || data.bpp_amount || data.business_personal_property || "";
  if (bpp) { data.business_personal_property = bpp; data.bpp_amount = bpp; }

  // 125 convenience (harmless if present): "See Remarks Below" + remarks text
  if (!data.description_of_insurance && (data.claim_count === "2_or_less" || data.claim_count === "3_or_more")) {
    data.description_of_insurance = "See Remarks Below";
  }
  if (!data.claims_remarks) {
    data.claims_remarks = data.claims_details_2_or_less || data.claims_details_3_or_more || data.remarks || "";
  }
  if (!data.remarks) data.remarks = data.claims_remarks;
})();

function yes(v){
  var s = String(v == null ? "" : v).toLowerCase();
  return s==="yes"||s==="true"||s==="1"||s==="on"||s==="y"||v===true||v===1;
}
function money(v){
  if (v === null || v === undefined || v === "") return "";
  var n = Number(String(v).replace(/[^0-9.-]/g,""));
  if (isNaN(n)) return String(v);
  return n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});
}
function formatDate(d){
  try{
    if(!d) return "";
    var dt = new Date(d);
    if(isNaN(dt.getTime())) return String(d);
    var mm=("0"+(dt.getMonth()+1)).slice(-2);
    var dd=("0"+dt.getDate()).slice(-2);
    var yy=dt.getFullYear();
    return mm+"/"+dd+"/"+yy;
  }catch(e){ return String(d||""); }
}
%>
<%
/* ---- Common aliases for 125/126/140 ---- */
const firstNamed = data.first_named_insured || data.applicant_name || data.namedInsured || "";

const mailStreet = data.applicant_mailing_address || data.applicant_street || data.mailing_street || "";
const mailCity   = data.applicant_city || data.mailing_city || "";
const mailState  = data.applicant_state || data.mailing_state || "";
const mailZip    = data.applicant_zip || data.mailing_zip || "";

const businessPhone = data.business_phone || data.businessPhone || data.phone || "";
const website       = data.website || data.website_address || data.web || "";

/* Type-of-business helper */
const typeIs = (t) => {
  const raw = (data.type_of_business || data.business_type || data.entity_type || "").toString().trim().toLowerCase();
  const map = {
    corporation: ['corp','corporation','inc','inc.'],
    llc:         ['llc','limited liability company'],
    partnership: ['partnership','llp','lp','general partnership','limited partnership'],
    individual:  ['individual','sole proprietor','sole proprietorship','sole prop','proprietor'],
    other:       ['other']
  };
  return (map[t]||[]).some(k => raw.includes(k));
};

/* Premises (LOC #1) */
const locStreet = data.premise_address || data.location1_street || "";
const locCity   = data.premise_city || data.location1_city || "";
const locState  = data.premise_state || data.location1_state || "";
const locZip    = data.premise_zip || data.location1_zip || "";
const bldgDesc  = data.bldg_description || data.building_description || "";

/* Employees / revenue / bldg area */
const ftEmp         = data.full_time_employees || data.ft_employees || data.ftEmp || "";
const ptEmp         = data.part_time_employees || data.pt_employees || data.ptEmp || "";
const annualRevenue = data.annual_revenue || data.annualRevenue || data.total_sales || "";
const bldgSqFt      = data.total_area || data.building_sq_ft || data.bldgSqFt || "";

const constructionType =
  (data.construction_type && String(data.construction_type)) ||
  (data.constructionType && String(data.constructionType)) ||
  (data.building_construction && String(data.building_construction)) ||
  (data.const_type && String(data.const_type)) ||"";


/* Additional Interest (page 3 / 140 section) */
const aiType  = data.interest_type || data.ai_type || "";
const aiName  = data.interest_name || data.ai_name_1 || "";
const aiAddr1 = data.interest_address || data.ai_address_1 || "";
const aiCity  = data.interest_city || data.ai_city_1 || "";
const aiState = data.interest_state || data.ai_state_1 || "";
const aiZip   = data.interest_zip || data.ai_zip_1 || "";
const aiRank  = data.interest_rank || data.ai_rank_1 || "";
const aiRef   = data.interest_reference || data.ai_reference_1 || "";

/* Applicant address for 126 header */
const applStreet = data.applicant_street || data.mailing_street || data.premise_address || "";
const applCity   = data.applicant_city || data.premise_city || "";
const applState  = data.applicant_state || data.premise_state || "";
const applZip    = data.applicant_zip || data.premise_zip || "";

/* Employees total (126 p2) */
const employeesTotal = data.num_employees || data.employees_total || ((Number(ftEmp)||0)+(Number(ptEmp)||0));

/* Keep 140 remarks from pulling 125 remarks */
const remarks140 = data.remarks_140 || data.remarks140 || "";
%>

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>BarAccord140 – Property Section</title>
  <style><%- styles %></style>
</head>
<body>

<!-- ====================== PAGE 1 ====================== -->
<div class="page">
  <div class="headerbar">
    <div class="acord">ACORD</div>
    <div class="title">PROPERTY SECTION</div>
    <div class="formno">140</div>
  </div>

  <!-- PRODUCER / APPLICANT -->
  <div class="subbar">PRODUCER / APPLICANT</div>
  <div class="block">
    <div class="row">
  <div class="cell label w20">AGENCY</div>
  <div class="cell w45">
    <%= data.producerName %><br/>
    <%= data.producerAddress1 %><br/>
    <%= data.producerAddress2 %>
  </div>
  <div class="cell label w15">AGENCY CUSTOMER ID</div>
  <div class="cell w10"><%= data.agencyCustomerId %></div>
  <div class="cell label w5">DATE</div>
  <div class="cell w5 right num"><%= formatDate(data.date) %></div>
</div>

<div class="row">
  <div class="cell label w25">APPLICANT / FIRST NAMED INSURED</div>
  <div class="cell w45"><%= data.applicant_name %></div>
  <div class="cell label w10">CARRIER</div>
  <div class="cell w10"><%= data.carrier %></div>
  <div class="cell label w5">NAIC</div>
  <div class="cell w5"><%= data.naicCode %></div>
</div>

    <div class="row">
      <div class="cell label w15">POLICY NUMBER</div>
      <div class="cell w25"><%= data.policyNumber %></div>
      <div class="cell label w20">EFFECTIVE DATE</div>
      <div class="cell w20"><%= formatDate(data.effectiveDate) %></div>
      <div class="cell label w10">PREMISES #</div>
      <div class="cell w10"><%= data.premises_number || "1" %></div>
    </div>
  </div>

  <!-- PREMISES INFORMATION -->
  <div class="subbar">PREMISES INFORMATION</div>
  <div class="block">
    <div class="row">
      <div class="cell label w10">BUILDING #</div>
      <div class="cell w10"><%= data.building_number || "1" %></div>
      <div class="cell label w20">BUILDING DESCRIPTION</div>
      <div class="cell w60"><%= data.bldg_description %></div>
    </div>
    <div class="row">
      <div class="cell label w15">STREET ADDRESS</div>
      <div class="cell w85">
        <% if(data.premises_name) { %><%= data.premises_name %><br/><% } %>
        <%= data.premise_address %>
        <% if(data.premise_city) { %>
          • <%= data.premise_city %>, <%= data.premise_state %> <%= data.premise_zip %>
        <% } %>
      </div>
    </div>
    <div class="row">
      <div class="cell label w20">FIRE DISTRICT / CODE #</div>
      <div class="cell w30"><%= data.fire_district %> <%= data.code_number %></div>
      <div class="cell label w20">PROTECTION CLASS</div>
      <div class="cell w30"><%= data.prot_class %></div>
    </div>
    <div class="row">
  <div class="cell label w20">EXPOSURE</div>
  <div class="cell label w20 center">FRONT</div>
  <div class="cell label w20 center">RIGHT</div>
  <div class="cell label w20 center">LEFT</div>
  <div class="cell label w20 center">REAR</div>
</div>
<div class="row">
  <div class="cell label w20 small">ADJACENT / DISTANCE</div>
  <div class="cell w20 center small">
    <%= data.front_exposure %><% if(data.front_distance){ %> — <%= data.front_distance %> ft<% } %>
  </div>
  <div class="cell w20 center small">
    <%= data.right_exposure %><% if(data.right_distance){ %> — <%= data.right_distance %> ft<% } %>
  </div>
  <div class="cell w20 center small">
    <%= data.left_exposure %><% if(data.left_distance){ %> — <%= data.left_distance %> ft<% } %>
  </div>
  <div class="cell w20 center small">
    <%= data.rear_exposure %><% if(data.rear_distance){ %> — <%= data.rear_distance %> ft<% } %>
  </div>
</div>


  <!-- SUBJECT OF INSURANCE (20-col; two-row per item for clean fit) -->
<div class="subbar">SUBJECT OF INSURANCE</div>
<div class="block">
  <!-- Header A -->
  <div class="row small label">
    <div class="cell w35">SUBJECT</div>
    <div class="cell w20 center">AMOUNT</div>
    <div class="cell w15 center">VALUATION</div>
    <div class="cell w10 center">CO-INS</div>
    <div class="cell w20 center">CAUSE OF LOSS</div>
  </div>
  <!-- Header B -->
  <div class="row small label">
    <div class="cell w15">DED</div>
    <div class="cell w15">PREMIUM</div>
    <div class="cell w10 center">BLKT #</div>
    <div class="cell w10 center">INFL %</div>
    <div class="cell w50">TYPE OF DED</div>
  </div>

  <!-- BUILDING -->
  <div class="row">
    <div class="cell w35">BUILDING</div>
    <div class="cell w20 right num">$<%= money(data.building_amount) %></div>
    <div class="cell w15 center"><%= data.building_valuation %></div>
    <div class="cell w10 center"><%= data.building_coins %></div>
    <div class="cell w20 center"><%= data.building_causes %></div>
  </div>
  <div class="row">
    <div class="cell w15 right num"><%= data.building_quote === "Yes" ? "Yes" : (data.building_quote === "No" ? "No" : data.building_ded) %></div>
    <div class="cell w15 right num"><%= data.building_premium %></div>
    <div class="cell w10 center"><%= data.building_blkt %></div>
    <div class="cell w10 right num"><%= data.building_infl %></div>
    <div class="cell w50"><%= data.building_ded_type %></div>
  </div>

  <!-- BUSINESS PERSONAL PROPERTY -->
  <div class="row">
    <div class="cell w35">BUSINESS PERSONAL PROPERTY</div>
    <div class="cell w20 right num">$<%= money(data.bpp_amount) %></div>
    <div class="cell w15 center"></div>
    <div class="cell w10 center"><%= data.bpp_coins %></div>
    <div class="cell w20 center"><%= data.bpp_causes %></div>
  </div>
  <div class="row">
    <div class="cell w15 right num"><%= data.bpp_ded %></div>
    <div class="cell w15 right num"><%= data.bpp_premium %></div>
    <div class="cell w10 center"><%= data.bpp_blkt %></div>
    <div class="cell w10 right num"><%= data.bpp_infl %></div>
    <div class="cell w50"><%= data.bpp_valuation %></div>
  </div>

  <!-- BUSINESS INCOME -->
  <div class="row">
    <div class="cell w35">BUSINESS INCOME</div>
    <div class="cell w20 right num">$<%= money(data.bi_amount) %></div>
    <div class="cell w15 center"><%= data.bi_valuation %></div>
    <div class="cell w10 center"><%= data.bi_coins %></div>
    <div class="cell w20 center"><%= data.bi_causes %></div>
  </div>
  <div class="row">
    <div class="cell w15 right num"><%= data.bi_ded %></div>
    <div class="cell w15 right num"><%= data.bi_premium %></div>
    <div class="cell w10 center"><%= data.bi_blkt %></div>
    <div class="cell w10 right num"><%= data.bi_infl %></div>
    <div class="cell w50"><%= data.bi_ded_type %></div>
  </div>

  <% if(data.other1_subject) { %>
  <div class="row">
    <div class="cell w35"><%= data.other1_subject %></div>
    <div class="cell w20 right num">$<%= money(data.other1_amount) %></div>
    <div class="cell w15 center"><%= data.other1_valuation %></div>
    <div class="cell w10 center"><%= data.other1_coins %></div>
    <div class="cell w20 center"><%= data.other1_causes %></div>
  </div>
  <div class="row">
    <div class="cell w15 right num"><%= data.other1_ded %></div>
    <div class="cell w15 right num"><%= data.other1_premium %></div>
    <div class="cell w10 center"><%= data.other1_blkt %></div>
    <div class="cell w10 right num"><%= data.other1_infl %></div>
    <div class="cell w50"><%= data.other1_ded_type %></div>
  </div>
  <% } %>
</div>


  <!-- MINE SUBSIDENCE / SINKHOLE -->
  <div class="block">
    <div class="row">
      <div class="cell label w20">MINE SUBSIDENCE</div>
      <div class="cell w15">
        <span class="check"><%= yes(data.mine_subsidence_accept) ? "X" : "" %></span> ACCEPT
      </div>
      <div class="cell w15">
        <span class="check"><%= yes(data.mine_subsidence_reject) ? "X" : "" %></span> REJECT
      </div>
      <div class="cell label w20">SINKHOLE</div>
      <div class="cell w15">
        <span class="check"><%= yes(data.sinkhole_accept) ? "X" : "" %></span> ACCEPT
      </div>
      <div class="cell w15">
        <span class="check"><%= yes(data.sinkhole_reject) ? "X" : "" %></span> REJECT
      </div>
    </div>
  </div>

  <!-- ADDITIONAL COVERAGES / OPTIONS / RESTRICTIONS -->
  <div class="subbar">ADDITIONAL COVERAGES / OPTIONS / RESTRICTIONS</div>
  <div class="block">
    <div class="row">
      <div class="cell label w20">SPOILAGE COVERAGE</div>
      <div class="cell w20">LIMIT: $<%= money(data.spoilage_limit) %></div>
      <div class="cell w20">DED: $<%= money(data.spoilage_ded) %></div>
      <div class="cell w40">APPLY? <span class="check"><%= yes(data.spoilage_yes) ? "X" : "" %></span></div>
    </div>
    <div class="row">
      <div class="cell label w20">BREAKDOWN / CONTAMINATION</div>
      <div class="cell w20">LIMIT: $<%= money(data.breakdown_contamination) %></div>
      <div class="cell w20">DED: $</div>
      <div class="cell w40">APPLY? <span class="check"></span></div>
    </div>
    <div class="row">
      <div class="cell label w30">REFRIGERATION MAINT AGREEMENT</div>
      <div class="cell w30">AGREEMENT #: <%= data.spoilage_refrig_maint %></div>
      <div class="cell w40">IN FORCE? <span class="check"></span></div>
    </div>
    <div class="row">
      <div class="cell label w30">POWER OUTAGE (OFF PREMISES)</div>
      <div class="cell w20">LIMIT: $<%= money(data.power_outage) %></div>
      <div class="cell w20">DED: $</div>
      <div class="cell w30">APPLY? <span class="check"></span></div>
    </div>
    <div class="row">
      <div class="cell label w20">ORDINANCE OR LAW</div>
      <div class="cell w20">LIMIT: $</div>
      <div class="cell w20">DED: $</div>
      <div class="cell w40">APPLY? <span class="check"></span></div>
    </div>
  </div>

  <div class="footnote">
    ACORD 140 (Bar Layout) &nbsp;&nbsp;&nbsp; Page 1 of 3
  </div>
</div>

<div class="pagebreak"></div>

<!-- ====================== PAGE 2 ====================== -->
<div class="page">
  <div class="headerbar">
    <div class="acord">ACORD</div>
    <div class="title">PROPERTY SECTION</div>
    <div class="formno">140</div>
  </div>

  <!-- CONSTRUCTION DETAILS -->
  <div class="subbar">CONSTRUCTION DETAILS</div>
  <div class="block">
    <div class="row">
      <div class="cell label w15">CONSTRUCTION TYPE</div>
      <div class="cell w20"><%= constructionType %></div>
      <div class="cell label w10">YEAR BUILT</div>
      <div class="cell w10"><%= data.year_built %></div>
      <div class="cell label w10"># OF STORIES</div>
      <div class="cell w10"><%= data.num_stories %></div>
      <div class="cell label w10">% SPRINK</div>
      <div class="cell w15"><%= data.percent_sprinkler %></div>
    </div>
    <div class="row">
      <div class="cell label w20">TOTAL AREA (SQ FT)</div>
      <div class="cell w15 right"><%= data.total_area %></div>
      <div class="cell label w15">ROOF TYPE</div>
      <div class="cell w20"><%= data.roof_type %></div>
      <div class="cell label w15">PROTECTION CLASS</div>
      <div class="cell w15"><%= data.prot_class %></div>
    </div>
    <div class="row">
  <div class="cell label w15">WIRING (YR)</div>
  <div class="cell w10 right num"><%= data.wiring_year %></div>
  <div class="cell label w15">ROOFING (YR)</div>
  <div class="cell w10 right num"><%= data.roofing_year %></div>
  <div class="cell label w15">PLUMBING (YR)</div>
  <div class="cell w10 right num"><%= data.plumbing_year %></div>
  <div class="cell label w15">HEATING (YR)</div>
  <div class="cell w10 right num"><%= data.heating_year %></div>
  </div>
  </div>

  <!-- PROTECTION / ALARMS -->
  <div class="subbar">PROTECTION / ALARMS</div>
  <div class="block">
    <div class="row">
      <div class="cell label w15">BURGLAR ALARM</div>
      <div class="cell w25"><%= data.burglar_alarm_type %></div>
      <div class="cell label w10">CERT #</div>
      <div class="cell w15"><%= data.burglar_alarm_cert %></div>
      <div class="cell label w10">EXP</div>
      <div class="cell w25"><%= data.burglar_alarm_exp %></div>
    </div>
    <div class="row">
      <div class="cell label w15">FIRE ALARM</div>
      <div class="cell w25"><%= data.fire_alarm_type %></div>
      <div class="cell label w10">CERT #</div>
      <div class="cell w15"></div>
      <div class="cell label w10">EXP</div>
      <div class="cell w25"></div>
    </div>
    <div class="row">
      <div class="cell label w20">CENTRAL STATION</div>
      <div class="cell w20"><%= data.central_station_burglar %></div>
      <div class="cell label w15">WITH KEYS?</div>
      <div class="cell w10">
        <span class="check"><%= yes(data.with_keys) ? "X" : "" %></span>
      </div>
      <div class="cell label w20">GUARDS/CLOCK HOURLY?</div>
      <div class="cell w15">
        <span class="check"><%= yes(data.clock_hourly) ? "X" : "" %></span>
      </div>
    </div>
  </div>

  <!-- BUSINESS INCOME / VALUE REPORTING -->
  <div class="subbar">BUSINESS INCOME / VALUE REPORTING</div>
  <div class="block">
    <div class="row">
      <div class="cell label w25">BUSINESS INCOME COVERAGE</div>
      <div class="cell w25"></div>
      <div class="cell label w15"># OF MONTHS</div>
      <div class="cell w35"></div>
    </div>
    <div class="row">
      <div class="cell label w25">EXTRA EXPENSE LIMIT</div>
      <div class="cell w25 right">$</div>
      <div class="cell label w25">REPORTING REQUIRED?</div>
      <div class="cell w25">
        <span class="check"></span>
      </div>
    </div>
  </div>

  <div class="subbar">ADDITIONAL PREMISES INFORMATION</div>
<div class="block">
  <div class="row no-break">
    <div class="cell w100 vstack no-hyphen">

      <!-- Free-text notes area -->
      <div class="u-mt10"><%= data.addl_premises_notes %></div>
    </div>
  </div>
</div>


  <!-- ADDITIONAL INTEREST / CERTIFICATE RECIPIENT -->
  <div class="subbar">ADDITIONAL INTEREST / CERTIFICATE RECIPIENT</div>
  <div class="block">
    <div class="row">
      <div class="cell label w10">TYPE</div>
      <div class="cell w90">
        <span class="check"><%= yes(data.ai_additional_insured) ? "X" : "" %></span> ADDITIONAL INSURED
        <span class="check"><%= yes(data.ai_loss_payee) ? "X" : "" %></span> LOSS PAYEE
        <span class="check"><%= yes(data.ai_mortgagee) ? "X" : "" %></span> MORTGAGEE
        <span class="check"><%= yes(data.ai_lienholder) ? "X" : "" %></span> LIENHOLDER
        <span class="check"></span> LENDER'S LOSS PAYABLE
      </div>
    </div>
    <div class="row">
  <div class="cell label w20">NAME AND ADDRESS</div>
  <div class="cell w45 wrap"><%- [
        data.ai_name_1 || data.interest_name || "",
        data.ai_address_1 || data.interest_address || "",
        [data.ai_city_1 || data.interest_city || "", 
         data.ai_state_1 || data.interest_state || "", 
         data.ai_zip_1 || data.interest_zip || ""]
          .filter(Boolean).join(", ")
      ].filter(Boolean).join("<br/>") %>
</div>
  <div class="cell label w10">RANK</div>
  <div class="cell w10"><%= data.interest_rank %></div>
  <div class="cell label w5">EVIDENCE</div>
  <div class="cell w10"><span class="check"></span> <span class="nowrap">CERTIFICATE</span></div>
</div>

    </div>
    <div class="row">
      <div class="cell label w15">REFERENCE / LOAN #</div>
      <div class="cell w85"><%= data.interest_reference %></div>
    </div>
    <div class="row">
  <div class="cell label w10">ITEM</div>
  <div class="cell w45">
    <span class="check"></span> <span class="nowrap">LOCATION</span>
    <span class="check"></span> <span class="nowrap">BUILDING</span>
    <span class="check"></span> <span class="nowrap">VEHICLE</span>
    <span class="check"></span> <span class="nowrap">BOAT</span>
  </div>
  <div class="cell label w15">ITEM CLASS</div>
  <div class="cell w10"><%= data.interest_item_class %></div>
  <div class="cell label w10">ITEM DESC</div>
  <div class="cell w10"><%= data.interest_item_desc %></div>
</div>

  <!-- REMARKS -->
  <div class="subbar">REMARKS</div>
  <div class="block">
    <div class="row" style="min-height:40px;">
      <div class="cell w100 wrap"><%= remarks140 %></div>
    </div>
  </div>

  <div class="footnote">
    ACORD 140 (Bar Layout) &nbsp;&nbsp;&nbsp; Page 2 of 3
  </div>
</div>


<!-- ====================== PAGE 3 ====================== -->
<div class="page">
  <div class="headerbar">
    <div class="acord">ACORD</div>
    <div class="title">PROPERTY SECTION</div>
    <div class="formno">140</div>
  </div>

  <!-- SIGNATURE -->
  <div class="subbar">SIGNATURE</div>
  <div class="block">
    <div class="row">
      <div class="cell w100 small wrap" style="padding:6px;">
        THE UNDERSIGNED IS AN AUTHORIZED REPRESENTATIVE OF THE APPLICANT AND REPRESENTS THAT REASONABLE INQUIRY HAS BEEN MADE TO OBTAIN THE
        ANSWERS TO QUESTIONS ON THIS APPLICATION. HE/SHE REPRESENTS THAT THE ANSWERS ARE TRUE, CORRECT AND COMPLETE TO THE BEST OF HIS/HER
        KNOWLEDGE.
      </div>
    </div>
    <div class="row">
      <div class="cell label w25">PRODUCER'S SIGNATURE</div>
      <div class="cell w25" style="border-bottom:1px solid #000;"></div>
      <div class="cell label w25">PRODUCER'S NAME (PLEASE PRINT)</div>
      <div class="cell w25"><%= data.producerSignatureName %></div>
    </div>
    <div class="row">
      <div class="cell label w25">STATE PRODUCER LICENSE NO</div>
      <div class="cell w25"></div>
      <div class="cell label w25">NATIONAL PRODUCER NUMBER</div>
      <div class="cell w25"></div>
    </div>
    <div class="row">
      <div class="cell label w25">APPLICANT'S SIGNATURE</div>
      <div class="cell w50"></div>
      <div class="cell label w10">DATE</div>
      <div class="cell w15"><%= formatDate(data.date) %></div>
    </div>
  </div>

  <!-- STATE FRAUD NOTICES -->
<div class="subbar">STATE FRAUD NOTICES</div>
<div class="fraud legal wrap">
  <p><strong>Applicable in AL, AR, LA, MD, NM, RI and WV:</strong> Any person who knowingly (or willfully)* presents a false or fraudulent claim for payment of a loss or benefit or knowingly (or willfully)* presents false information in an application for insurance is guilty of a crime and may be subject to fines and confinement in prison. *Applies in MD Only.</p>

  <p><strong>Applicable in CA:</strong> For your protection, California law requires the following to appear on this form: Any person who knowingly presents false or fraudulent information to obtain or amend insurance coverage or to make a claim for the payment of a loss is guilty of a crime and may be subject to fines and confinement in state prison.</p>

  <p><strong>Applicable in CO:</strong> It is unlawful to knowingly provide false, incomplete, or misleading facts or information to an insurance company for the purpose of defrauding or attempting to defraud the company. Penalties may include imprisonment, fines, denial of insurance and civil damages. Any insurance company or agent of an insurance company who knowingly provides false, incomplete, or misleading facts or information to a policyholder or claimant for the purpose of defrauding or attempting to defraud the policyholder or claimant with regard to a settlement or award payable from insurance proceeds shall be reported to the Colorado Division of Insurance within the Department of Regulatory Agencies.</p>

  <p><strong>Applicable in DC:</strong> WARNING: It is a crime to provide false or misleading information to an insurer for the purpose of defrauding the insurer or any other person. Penalties include imprisonment and/or fines. In addition, an insurer may deny insurance benefits if false information materially related to a claim was provided by the applicant.</p>

  <p><strong>Applicable in FL and OK:</strong> Any person who knowingly and with intent to injure, defraud, or deceive any insurer files a statement of claim or an application containing any false, incomplete, or misleading information is guilty of a felony (of the third degree)*. *Applies in FL Only.</p>

  <p><strong>Applicable in KS:</strong> Any person who, knowingly and with intent to defraud, presents, causes to be presented or prepares with knowledge or belief that it will be presented to or by an insurer, purported insurer, broker or any agent thereof, any written, electronic, electronic impulse, facsimile, magnetic, oral, or telephonic communication or statement as part of, or in support of, an application for the issuance of, or the rating of an insurance policy for personal or commercial insurance, or a claim for payment or other benefit pursuant to an insurance policy for commercial or personal insurance which such person knows to contain materially false information concerning any fact material thereto; or conceals, for the purpose of misleading, information concerning any fact material thereto commits a fraudulent insurance act.</p>

  <p><strong>Applicable in KY, OH and PA:</strong> Any person who knowingly and with intent to defraud any insurance company or other person files an application for insurance or statement of claim containing any materially false information or conceals for the purpose of misleading, information concerning any fact material thereto commits a fraudulent insurance act, which is a crime and subjects such person to criminal and civil penalties.</p>

  <p><strong>Applicable in ME, TN, VA and WA:</strong> It is a crime to knowingly provide false, incomplete or misleading information to an insurance company for the purpose of defrauding the company. Penalties (may)* include imprisonment, fines and denial of insurance benefits. *Applies in ME Only.</p>

  <p><strong>Applicable in NJ:</strong> Any person who includes any false or misleading information on an application for an insurance policy is subject to criminal and civil penalties.</p>

  <p><strong>Applicable in NY:</strong> Any person who knowingly and with intent to defraud any insurance company or other person files an application for insurance or statement of claim containing any materially false information, or conceals for the purpose of misleading, information concerning any fact material thereto, commits a fraudulent insurance act, which is a crime, and shall also be subject to a civil penalty not to exceed five thousand dollars and the stated value of the claim for each such violation.</p>

  <p><strong>Applicable in OR:</strong> Any person who knowingly and with intent to defraud or solicit another to defraud the insurer by submitting an application containing a false statement as to any material fact may be violating state law.</p>

  <p><strong>Applicable in PR:</strong> Any person who knowingly and with the intention of defrauding presents false information in an insurance application, or presents, helps, or causes the presentation of a fraudulent claim for the payment of a loss or any other benefit, or presents more than one claim for the same damage or loss, shall incur a felony and, upon conviction, shall be sanctioned for each violation by a fine of not less than five thousand dollars ($5,000) and not more than ten thousand dollars ($10,000), or a fixed term of imprisonment for three (3) years, or both penalties. Should aggravating circumstances be present, the penalty thus established may be increased to a maximum of five (5) years; if extenuating circumstances are present, it may be reduced to a minimum of two (2) years.</p>
</div>


  <!-- Agency Customer ID at bottom -->
  <div class="block">
    <div class="row">
      <div class="cell label w25">AGENCY CUSTOMER ID</div>
      <div class="cell w75"><%= data.agencyCustomerId %></div>
    </div>
  </div>

  <div class="footnote">
    ACORD 140 (Bar Layout) &nbsp;&nbsp;&nbsp; Page 3 of 3
  </div>
</div>

</body>
</html>
